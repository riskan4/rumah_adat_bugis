<!DOCTYPE HTML>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tur 360° Rumah Adat Bugis (Bola Ugi)</title>

  <!-- Pannellum -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css"/>
  <script src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>

  <!-- Gaya tur (mirip struktur contoh dosen) -->
  <link rel="stylesheet" href="css/vtour.css">
</head>
<body>

  <!-- TOP BAR -->
  <div class="top-bar">
    <a href="index.html" class="go-home">← Kembali ke Beranda</a>
    <h3 class="page-title">Pannellum Virtual Tour — Rumah Adat Bugis</h3>
    <div class="top-bar__actions">
      <button class="minimap-btn" onclick="showMinimap()">Tampilkan Minimap</button>
      <button id="toggleDragBtn" class="minimap-btn">Nonaktifkan Drag</button>
    </div>
  </div>

  <!-- MODAL MINIMAP -->
  <div id="minimapModal" class="minimap-modal" onclick="hideMinimap()">
    <img src="assets/images/minimap.jpg" alt="Minimap Virtual Tour" class="minimap-img">
  </div>

  <!-- VIEWER -->
  <div id="panorama"></div>

  <!-- STATIC SCENE BUTTONS (01–11) -->
  <div class="scenes">
    <button onclick="viewer.loadScene('scene01')">01</button>
    <button onclick="viewer.loadScene('scene02')">02</button>
    <button onclick="viewer.loadScene('scene03')">03</button>
    <button onclick="viewer.loadScene('scene04')">04</button>
    <button onclick="viewer.loadScene('scene05')">05</button>
    <button onclick="viewer.loadScene('scene06')">06</button>
    <button onclick="viewer.loadScene('scene07')">07</button>
    <button onclick="viewer.loadScene('scene08')">08</button>
    <button onclick="viewer.loadScene('scene09')">09</button>
    <button onclick="viewer.loadScene('scene10')">10</button>
    <button onclick="viewer.loadScene('scene11')">11</button>
  </div>

  <script>
    // ---------- Helper hotspot ----------
    function navHotspot(yaw, pitch, text, target) {
      return { yaw, pitch, type: "scene", text, sceneId: target, targetYaw: 0, targetPitch: 0 };
    }

    // ---------- Inisialisasi Pannellum ----------
    var viewer = pannellum.viewer('panorama', {
      "default": {
        "firstScene": "scene01",
        "author": "Kelompok Bone — Rumah Adat Bugis",
        "sceneFadeDuration": 1000,
        "autoLoad": true,
        "compass": true,
        "northOffset": 0,
        "hfov": 95,
        "pitch": 0,
        "yaw": 0,
        "showFullscreenCtrl": true,
        "showZoomCtrl": true
      },

      "scenes": {
        /* SCENE 1 — 1 hotspot */
        "scene01": {
          "title": "Scene 1 — Halaman Depan & Fasade",
          "type": "equirectangular",
          "panorama": "assets/360_images/image1.jpg",
          "hotSpots": [
            navHotspot(0, 3, "Depan tangga (Scene 2)", "scene02")
          ]
        },

        /* SCENE 2 — 4 hotspot */
        "scene02": {
          "title": "Scene 2 — Tangga Depan",
          "type": "equirectangular",
          "panorama": "assets/360_images/image2.jpg",
          "hotSpots": [
            navHotspot(90, -3, "Kembali ke Scene 1", "scene01"),
            navHotspot(0, 23, "Ke Scene 11 (Pintu depan)", "scene11"),
            navHotspot(-90, -5, "Ke Scene 3 (Kolom tengah Rumah)", "scene03"),
            navHotspot(-80, 0, "Ke Scene 4 (Tangga Belakang Rumah)", "scene04")
          ]
        },

        /* SCENE 3 — 3 hotspot */
        "scene03": {
          "title": "Scene 3 — Kolom Rumah Tengah",
          "type": "equirectangular",
          "panorama": "assets/360_images/image3.jpg",
          "hotSpots": [
            navHotspot(-95, -8, "Ke Tangga Depan (Scene 2)", "scene02"),
            navHotspot(-90, -2, "Ke Depan Rumah (Scene 1)", "scene01"),
            navHotspot(108, 0, "Ke Tangga Belakang (Scene 4)", "scene04")
          ]
        },

        /* SCENE 4 — 3 hotspot */
        "scene04": {
          "title": "Scene 4 — Tangga Belakang Rumah",
          "type": "equirectangular",
          "panorama": "assets/360_images/image4.jpg",
          "hotSpots": [
            navHotspot(90, 0, "Ke Tangga Depan (Scene 2)", "scene02"),
            navHotspot(100, -5, "Ke Kolom Tengah (Scene 3)", "scene03"),
            navHotspot(10, 5, "Naik Ke Pintu Belakang (Scene 5)", "scene05")
          ]
        },

        /* SCENE 5 — 2 hotspot */
        "scene05": {
          "title": "Scene 5 — Pintu Belakang Rumah",
          "type": "equirectangular",
          "panorama": "assets/360_images/image5.jpg",
          "hotSpots": [
            navHotspot(5, -50, "Tangga Belakang (Scene 4)", "scene04"),
            navHotspot(-90, -20, "Ke Dapur (Scene 6)", "scene06")
          ]
        },

        /* SCENE 6 — 3 hotspot */
        "scene06": {
          "title": "Scene 6 — Dapur",
          "type": "equirectangular",
          "panorama": "assets/360_images/image6.jpg",
          "hotSpots": [
            navHotspot(-170, 0, "Ke Ruang Keluarga (Scene 4)", "scene04"),
            navHotspot(10, 0, "Ke Kamar Belakang (Scene 7)", "scene07"),
            navHotspot(45, 0, "Ke Pertigaan (Scene 8)", "scene08")
          ]
        },

        /* SCENE 7 — 1 hotspot */
        "scene07": {
          "title": "Scene 7 — Gudang",
          "type": "equirectangular",
          "panorama": "assets/360_images/image7.jpg",
          "hotSpots": [
            navHotspot(-170, 0, "Ke Koridor (Scene 6)", "scene06")
          ]
        },

        /* SCENE 8 — 5 hotspot */
        "scene08": {
          "title": "Scene 8 — Pertigaan Rumah",
          "type": "equirectangular",
          "panorama": "assets/360_images/image8.jpg",
          "hotSpots": [
            navHotspot(-170, 0, "Ke Koridor (Scene 6)", "scene06"),
            navHotspot(20, -2, "Ke Teras Belakang (Scene 9)", "scene09"),
            navHotspot(90, -2, "Ke Dekat Pintu (Scene 10)", "scene10"),
            navHotspot(-90, -2, "Ke Kolom Tengah (Scene 3)", "scene03"),
            navHotspot(150, -2, "Ke Tampak Samping (Scene 11)", "scene11")
          ]
        },

        /* SCENE 9 — 4 hotspot */
        "scene09": {
          "title": "Scene 9 — Tengah Rumah",
          "type": "equirectangular",
          "panorama": "assets/360_images/image9.jpg",
          "hotSpots": [
            navHotspot(-170, 0, "Ke Pertigaan (Scene 8)", "scene08"),
            navHotspot(10, -5, "Ke Kolong (Scene 10)", "scene10"),
            navHotspot(-30, -2, "Ke Kolom Tengah (Scene 3)", "scene03"),
            navHotspot(150, -2, "Ke Tampak Samping (Scene 11)", "scene11")
          ]
        },

        /* SCENE 10 — 2 hotspot */
        "scene10": {
          "title": "Scene 10 — Dekat Pintu Masuk",
          "type": "equirectangular",
          "panorama": "assets/360_images/image10.jpg",
          "hotSpots": [
            navHotspot(-150, 0, "Ke Tengah Rumah (Scene 9)", "scene09"),
            navHotspot(40, 0, "Ke Tampak Samping (Scene 11)", "scene11")
          ]
        },

        /* SCENE 11 — 3 hotspot */
        "scene11": {
          "title": "Scene 11 — Sudut Halaman & Tampak Samping",
          "type": "equirectangular",
          "panorama": "assets/360_images/image11.jpg",
          "hotSpots": [
            navHotspot(-170, 0, "Ke Halaman Depan (Scene 1)", "scene01"),
            navHotspot(20, 0, "Ke Pertigaan (Scene 8)", "scene08"),
            navHotspot(-30, 0, "Ke Tengah Rumah (Scene 9)", "scene09")
          ]
        }
      }
    });

    // ---------- Minimap modal ----------
    function showMinimap(){ document.getElementById('minimapModal').classList.add('active'); }
    function hideMinimap(){ document.getElementById('minimapModal').classList.remove('active'); }

    // ---------- Mode baca koordinat (toggle drag) ----------
    const panoramaEl = document.getElementById('panorama');
    const toggleBtn = document.getElementById('toggleDragBtn');
    const coordDiv = document.createElement('div');

    coordDiv.className = 'coord-hint';
    coordDiv.textContent = 'Klik panorama untuk koordinat (saat drag nonaktif)';
    document.body.appendChild(coordDiv);

    let dragEnabled = true;
    const viewerContainer = typeof viewer.getContainer === 'function' ? viewer.getContainer() : panoramaEl;

    function showCoords(e){
      const c = viewer.mouseEventToCoords(e);
      if (c && Number.isFinite(c.yaw) && Number.isFinite(c.pitch)) {
        coordDiv.textContent = `Yaw: ${c.yaw.toFixed(2)}, Pitch: ${c.pitch.toFixed(2)}`;
      }
    }

    function disableDrag(){
      dragEnabled = false;
      viewerContainer.style.cursor = 'pointer';
      viewerContainer.addEventListener('click', showCoords, true);
      toggleBtn.textContent = 'Aktifkan Drag';
    }

    function enableDrag(){
      dragEnabled = true;
      viewerContainer.style.cursor = 'grab';
      viewerContainer.removeEventListener('click', showCoords, true);
      toggleBtn.textContent = 'Nonaktifkan Drag';
      coordDiv.textContent = 'Klik panorama untuk koordinat (saat drag nonaktif)';
    }

    toggleBtn.onclick = () => dragEnabled ? disableDrag() : enableDrag();
    enableDrag(); // set awal
  </script>

</body>
</html>
